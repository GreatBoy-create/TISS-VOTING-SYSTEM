<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student of the Week Admin</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        
/* General Styles */

*{
    align-items: center;
    align-content: center;
    align-self: center;
}
html {
    align-items: center;
    align-content: center;
    align-self: center;
}
body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    color: #333333;
    text-align: center;
    background: #f9f9f9;
    animation: fadeIn 1s ease-out;
    overflow-x: hidden;
    align-items: center;
    align-content: center;
    align-self: center;
}



.subheader {
    font-size: 15px;
    color: rgb(232, 227, 203);
    margin-top: 4px;
    animation: fadeInUp 0.8s ease 0.3s both;
}

.subheader1 {
    font-size: 20px;
    color: rgb(232, 227, 203);
    margin-top: 4px;
    animation: fadeInUp 0.8s ease 0.3s both;
    font-style: unset;
    position: relative;
    padding-bottom: 15px; /* Increased padding to create more space */
    display: inline-block;
    margin-bottom: 20px;
}

.subheader1::after {
    content: '';
    position: absolute;
    bottom: 0; /* Position at the bottom of the padding area */
    left: 0;
    width: 100%;
    height: 2px;
    background: #b39e9e;
    transform: scaleX(0);
    transform-origin: center;
    transition: transform 0.5s ease;
    animation: drawLine 1.2s forwards 0.5s;
    /* Remove margin-bottom from here as it doesn't work on absolute elements */
}

/* Additional CSS to ensure proper spacing after the element */
.header .subheader1-container {
    margin-bottom: 20px;
    display: inline-block;
}

@keyframes drawLine {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }
    100% {
        transform: scaleX(1);
        opacity: 1;
    }
}

/* Dashboard Stats */
.dashboard-stats {
    display: flex;
    justify-content: space-between;
    max-width: 1000px;
    margin: 0 auto 18px;
    gap: 15px;

    padding: 0 20px;
    animation: fadeInStagger 0.8s ease-out both;
}

.stat-card {
    background-color: #006407;
    border-radius: 8px;
    padding: 18px;
    flex: 1;
    display: flex;
    align-items: center;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
    animation: cardPulse 2s infinite alternate;
    transition: transform 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-card:nth-child(1) { animation-delay: 0s; }
.stat-card:nth-child(2) { animation-delay: 0.2s; }
.stat-card:nth-child(3) { animation-delay: 0.4s; }

.stat-icon {
    background-color: rgb(232, 227, 203);
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    font-size: 20px;
    transition: transform 0.3s ease;
}

.stat-card:hover .stat-icon {
    transform: rotate(10deg) scale(1.1);
}

.stat-content h3 {
    font-size: 26px;
    font-weight: 600;
    margin: 0 0 4px 0;
    color: white;
}

.stat-content p {
    margin: 0;
    font-size: 14px;
    opacity: 0.9;
    color: white;
}

/* Container */
.container {
    background: rgba(255, 255, 255, 0.95);
    padding: 20px;
    border-radius: px;
    width: 85%;
    max-width: 900px;
    margin: 0 auto 30px;
    border: #006400 1px solid;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease-in-out;
    animation: fadeInUp 0.8s ease 0.5s both;
}

.container:hover {
    transform: scale(1.01);
}

/* Heading */
h2 {
    margin-bottom: 18px;
    color: #006400;
    font-size: 20px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    position: relative;
    display: inline-block;
    padding-bottom: 8px;
    text-align: left;
    animation: slideIn 1s ease-out;
}

h2::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: rgba(0, 100, 0, 0.3);
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 40px 20px;
}

.empty-state i {
    font-size: 40px;
    color: rgba(0, 100, 0, 0.5);
    margin-bottom: 15px;
}

.empty-state p {
    font-size: 15px;
    color: #006400;
    max-width: 300px;
    margin: 0 auto;
    line-height: 1.6;
}

/* Submission List */
.submission-list {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    margin-top: 15px;
    min-height: 160px;
}

/* Submission Card */


.submission-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

/* Card Paragraphs */
.submission-card p {
    margin: 4px 0;
    font-size: 13px;
    width: 94%;
    text-align: left;
    line-height: 1.35;
    color: #0f0b0b;
    padding: 6px 10px;
    border-radius: 5px;
    border-left: 2px solid transparent;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.submission-card p:hover {
    background-color: rgba(0, 100, 0, 0.05);
    transform: translateX(6px);
    border-left: 2px solid #a5e0a8;
}

.submission-card p:nth-child(odd) {
    background-color: rgba(80, 88, 80, 0.18);
    background-image: linear-gradient(to right, rgba(255, 255, 255, 0.03), transparent);
}

.submission-card p:nth-child(even) {
    background-color: rgba(115, 125, 115, 0.25);
    background-image: linear-gradient(to right, rgba(255, 255, 255, 0.05), transparent);
}

/* Reduce space between paragraph elements */
.submission-card p + p {
    margin-top: 0;
}

/* Strong tag and colon styling */
.submission-card p strong,
.leading-card p strong {
    color: #05670a;
    font-weight: 600;
    margin-right: 12px;
    min-width: 110px;
    display: inline-block;
    position: relative;
}

.submission-card p strong::after,
.leading-card p strong::after {
    content: ':';
    position: absolute;
    right: 6px;
    color: #038c07 !important;
    font-weight: 700;
    text-shadow: 0 0 1px rgba(0, 0, 0, 0.2);
    transform: translateY(-1px);
}

.submission-card p:hover strong::after,
.leading-card p:hover strong::after {
    color: #04c70b !important;
}

/* Card heading */
.submission-card h3 {
    color: #906e00;
    font-size: 16px;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
    animation: titleGlow 3s infinite alternate;
    text-align: center;
    width: 100%;
    padding-bottom: 6px;
    border-bottom: 1px solid rgba(0, 100, 0, 0.2);
}

/* Add line clamp for reason field */
.submission-card p:nth-child(3) {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    max-height: 3.4em;
    overflow: hidden;
    text-overflow: ellipsis;
}

.submission-card p:nth-child(3):hover {
    -webkit-line-clamp: initial;
    max-height: none;
}

/* Special styling for votes count */
.submission-card p:nth-child(6) strong,
.submission-card p:nth-child(6) {
    font-weight: 700;
}

/* Date styling with green color */
.submission-card p:last-of-type strong,
.submission-card p:last-of-type,
.leading-card p:last-of-type strong,
.leading-card p:last-of-type {
    color: #038c07 !important;
    font-style: italic;
    font-size: 13px;
}

.leading-card p:last-of-type strong,
.leading-card p:last-of-type {
    font-weight: 500;
}

.submission-card p:last-of-type:hover,
.leading-card p:last-of-type:hover {
    color: #04a90a !important;
}

/* Enhanced Leading Card with Winner Effects */
.leading-card {
    text-align: center;
    background: linear-gradient(135deg, #fcfcfc 0%, #f9f9f9 100%);
    color: #024b05;
    font-weight: lighter;
    width: 70%;
    margin: 0 auto 25px;
    padding: 20px 14px 60px; /* Extra padding at bottom for button */
    border-radius: 12px;
    font-size: 13px;
    box-shadow: 0 10px 25px rgba(0, 100, 0, 0.25);
    max-height: 320px;
    overflow-y: auto;
    position: relative;
    border: 2px solid transparent;
    border-image: linear-gradient(45deg, rgba(1, 118, 38, 0.541), #489900, #FFA500);
    border-image-slice: 1;
    transition: transform 0.5s ease-in-out, box-shadow 0.5s ease;
    animation: winnerCardPulse 3s infinite;
    z-index: 2;
}

.leading-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(202, 169, 0, 0.871), transparent);
    z-index: -1;
    border-radius: 10px;
}

.leading-card::after {
    content: '';
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    height: 10px;
    background: linear-gradient(90deg, transparent, rgb(255, 217, 0), transparent);
    border-radius: 50%;
    filter: blur(5px);
    animation: glowTop 2.5s infinite;
}

.leading-card:hover {
    transform: scale(1.03);
    box-shadow: 0 15px 30px rgba(0, 100, 0, 0.3), 0 0 20px rgba(255, 215, 0, 0.5);
}

/* Special heading for leading student */
.leading-card h3 {
    color: #ffffff;
    font-size: 18px !important;
    letter-spacing: 2px;
    margin: 0px auto 15px !important;
    padding: 7px 15px;
    background: linear-gradient(45deg, #277816, #00ba03);
    border-radius: 30px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    position: relative;
    display: inline-block;
    transform: translateY(0);
    animation: floatTitle 3s ease-in-out infinite;
    z-index: 3;
    max-width: 200px;
}

.leading-card h3::before, .leading-card h3::after {
    content: '★';
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 16px;
    color: white;
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
}

.leading-card h3::before {
    left: -5px;
    animation: rotateStar 3s linear infinite;
}

.leading-card h3::after {
    right: -5px;
    animation: rotateStar 3s linear infinite reverse;
}

/* Trophy icon container */
.trophy-container {
    position: absolute;
    top: -25px;
    right: -10px;
    width: 50px;
    height: 50px;
    animation: floatTrophy 3s ease-in-out infinite;
    z-index: 10;
}

/* Confetti effect */
.confetti-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
}

.confetti {
    position: absolute;
    width: 10px;
    height: 10px;
    background-color: rgb(0, 255, 42);
    opacity: 0.8;
    animation: confettiFall 5s linear infinite;
}

.confetti:nth-child(2n) {
    background-color: #00ff26;
    width: 7px;
    height: 7px;
    animation-duration: 4s;
    animation-delay: 0.5s;
}

.confetti:nth-child(3n) {
    background-color: #00b300;
    width: 12px;
    height: 12px;
    animation-duration: 6s;
    animation-delay: 1s;
}

.confetti:nth-child(4n) {
    background-color: white;
    width: 8px;
    height: 8px;
    animation-duration: 7s;
    animation-delay: 1.5s;
}

/* Leading card paragraphs */
.leading-card p {
    background-color: rgba(255, 255, 255, 0.7) !important;
    margin: 7px 0 !important;
    border-radius: 6px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    position: relative;
    z-index: 2;
}

.leading-card p strong {
    color: #006400;
    font-weight: 700;
}

/* Button container for proper positioning */
.button-wrapper {
    position: absolute;
    bottom: 10px;
    left: 0;
    width: 100%;
    text-align: center;
    z-index: 10;
}

/* Button wrapper for proper positioning */
.button-wrapper {
    position: absolute;
    bottom: 10px;
    right: 15px; /* Changed from left: 0 to right: 15px */
    width: auto; /* Changed from width: 100% */
    text-align: right; /* Changed from text-align: center */
    z-index: 10;
}

/* Improved button for leading card */
.leading-card .button-wrapper button {
    background: linear-gradient(45deg, #01d243, #076d0ea7);
    color: #ffffff;
    font-weight: 700;
    padding: 10px 20px;
    margin: 8px 0;
    border-radius: 30px;
    border: 2px solid rgba(0, 91, 2, 0.278);
    position: relative;
    z-index: 10;
    display: inline-block;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    text-shadow: 0 1px 1px rgba(255, 255, 255, 0.5);
    transition: all 0.3s ease;
    font-size: 14px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    overflow: visible;
}

.leading-card .button-wrapper button::before {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    background: rgba(11, 107, 50, 0.2);
    border-radius: 35px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.leading-card .button-wrapper button:hover {
    transform: translateY(-3px) scale(1.05);
    background: rgb(0, 109, 18);
    box-shadow: 0 7px 15px rgb(255, 255, 255), 0 0 10px rgba(255, 215, 0, 0.5);
    cursor: pointer;
}

.leading-card .button-wrapper button:hover::before {
    opacity: 1;
    animation: pulseButton 1.5s infinite;
}

.leading-card .button-wrapper button:active {
    transform: translateY(1px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* Make sure the leading card has correct positioning context */
.leading-card {
    position: relative;
    padding-bottom: 60px; /* Add space for the button at bottom */
}

/* Animation for the button pulse effect */
@keyframes pulseButton {
    0% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.1); opacity: 0.3; }
    100% { transform: scale(1); opacity: 0.5; }
}

/* Responsive adjustments for the button positioning */
@media screen and (max-width: 768px) {
    .button-wrapper {
        right: 10px;
        bottom: 8px;
    }
    
    .leading-card .button-wrapper button {
        padding: 8px 16px;
        font-size: 12px;
    }
}

@media screen and (max-width: 480px) {
    .button-wrapper {
        right: 8px;
        bottom: 5px;
    }
    
    .leading-card .button-wrapper button {
        padding: 6px 12px;
        font-size: 11px;
    }
    
    .leading-card {
        padding-bottom: 50px;
    }
}

/* Regular buttons */
button {
    background: #038c07;
    color: white;
    padding: 7px 14px;
    border: none;
    cursor: pointer;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
    margin-top: 10px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, background 0.3s ease;
}

.submission-card button {
    align-self: flex-end;
    margin-top: 8px;
    padding: 5px 12px;
    background: #007f00;
}

button::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: rgba(255, 255, 255, 0.3);
    transform: scaleX(0);
    transform-origin: right;
    transition: transform 0.5s ease;
}

button:hover {
    background: #006400;
    transform: translateY(-2px);
}

button:hover::after {
    transform: scaleX(1);
    transform-origin: left;
}

/* Action Buttons */
.button-container {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 22px;
}

.download-button, .clear-button {
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 13px;
    font-weight: 500;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
}

.download-button {
    background: #038c07;
    color: white;
}

.clear-button {
    background: #e74c3c;
    color: white;
}

.download-button i, .clear-button i {
    margin-right: 8px;
    font-size: 13px;
}

.download-button:hover {
    background: #036d06;
    transform: translateY(-2px);
}

.clear-button:hover {
    background: #c0392b;
    transform: translateY(-2px);
}

/* Position indicator for student ranking */
.position-indicator {
    position: absolute;
    top: 5px;
    right: 5px;
    background-color: #038c07;
    color: white;
    padding: 3px 8px;
    border-radius: 50%;
    font-size: 14px;
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    opacity: 0;
    transform: scale(0.8);
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index: 10;
}

/* Footer */
.footer {
    z-index: 999;
    background-color: #004d00;
    text-align: center;
    color: white;
    padding: 15px 0;
    margin-top: 20px;
    bottom: 0;
    width: 100%;
    animation: fadeInUp 0.8s ease 2s both;
}

.footer p {
    font-size: 13px;
    margin-top: 4px;
}

/* Social Icons */
.social-icons a {
    margin: 0 10px;
    color: rgb(232, 227, 203);
    font-size: 22px;
    margin-bottom: 25px;
    text-decoration: none;
    transition: transform 0.3s ease, color 0.3s ease;
}

.social-icons a:hover {
    color: rgb(255, 255, 255);
    transform: scale(1.1);
    text-decoration: none;
}

/* Define slideLabel animation if not already defined elsewhere */
@keyframes slideLabel {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Responsive Styles */

/* Tablet (768px to 992px) */
@media screen and (max-width: 992px) {
    .footer {
        padding: 12px 0;
    }
    
    .footer p {
        font-size: 13px;
    }
    
    .social-icons a {
        font-size: 22px;
        margin: 0 8px;
    }
    
    .social-icons a:hover {
        font-size: 24px;
        margin: 0 10px;
    }
}

/* Mobile (576px to 768px) */
@media screen and (max-width: 768px) {
    .footer {
        padding: 10px 0;
    }
    
    .footer p {
        font-size: 12px;
        margin: 4px 0;
        padding: 0 15px; /* Add padding for better text wrapping */
    }
    
    .social-icons {
        padding: 3px 0;
    }
    
    .social-icons a {
        font-size: 20px;
        margin: 0 7px;
    }
    
    .social-icons a:hover {
        font-size: 22px;
        margin: 0 8px;
    }
}

/* Small Mobile (up to 576px) */
@media screen and (max-width: 576px) {
    .footer {
        padding: 8px 0;
    }
    
    .footer p {
        font-size: 11px;
        line-height: 1.4;
        margin: 3px 0;
    }
    
    .social-icons {
        flex-wrap: wrap; /* Allow icons to wrap if needed */
        padding: 2px 0;
    }
    
    .social-icons a {
        font-size: 18px;
        margin: 0 6px;
    }
    
    .social-icons a:hover {
        font-size: 20px;
        margin: 0 7px;
    }
}

/* Very Small Screens (up to 320px) */
@media screen and (max-width: 320px) {
    .footer {
        padding: 6px 0;
    }
    
    .footer p {
        font-size: 10px;
        margin: 2px 0;
    }
    
    .social-icons a {
        font-size: 16px;
        margin: 0 5px;
    }
    
    .social-icons a:hover {
        font-size: 18px;
        margin: 0 6px;
    }
}

/* Fix for devices with notches */
@supports (padding: max(0px)) {
    .footer {
        padding-bottom: max(15px, env(safe-area-inset-bottom));
    }
}

/* Fix for landscape mode on mobile */
@media screen and (max-height: 450px) and (orientation: landscape) {
    .footer {
        position: relative; /* Change from fixed to relative in landscape */
        margin-top: 20px;
    }
}

/* Adjustments for iOS Safari */
@supports (-webkit-touch-callout: none) {
    .footer {
        /* Fix for iOS Safari viewport issues */
        bottom: env(safe-area-inset-bottom, 0);
    }
}
/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes fadeInUp {
    from { 
        opacity: 0;
        transform: translateY(20px);
    }
    to { 
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInCard {
    from { 
        opacity: 0; 
        transform: scale(0.95); 
    }
    to { 
        opacity: 1; 
        transform: scale(1); 
    }
}

@keyframes fadeInStagger {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes slideIn {
    from { transform: translateY(-25px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

@keyframes headerSlideDown {
    from { transform: translateY(-100%); }
    to { transform: translateY(0); }
}

@keyframes lightBar {
    0% { left: -100%; }
    100% { left: 100%; }
}

@keyframes titleGlow {
    0% { text-shadow: 0 0 5px rgba(255, 255, 255, 0.3); }
    100% { text-shadow: 0 0 15px rgba(255, 255, 255, 0.7), 0 0 30px rgba(255, 255, 255, 0.4); }
}

@keyframes cardPulse {
    0% { box-shadow: 0 3px 8px rgba(0, 100, 0, 0.2); }
    100% { box-shadow: 0 5px 15px rgba(0, 100, 0, 0.3); }
}

@keyframes winnerCardPulse {
    0% { box-shadow: 0 10px 25px rgba(0, 100, 0, 0.25); }
    50% { box-shadow: 0 10px 30px rgba(0, 100, 0, 0.4), 0 0 20px rgba(255, 215, 0, 0.3); }
    100% { box-shadow: 0 10px 25px rgba(0, 100, 0, 0.25); }
}

@keyframes floatTitle {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

@keyframes floatTrophy {
    0%, 100% { transform: translateY(0) rotate(0); }
    50% { transform: translateY(-8px) rotate(5deg); }
}

@keyframes glowTop {
    0%, 100% { opacity: 0.3; width: 70%; }
    50% { opacity: 0.8; width: 90%; }
}

@keyframes rotateStar {
    0% { transform: translateY(-50%) rotate(0deg); }
    100% { transform: translateY(-50%) rotate(360deg); }
}

@keyframes confettiFall {
    0% { 
        transform: translateY(-50px) rotate(0deg); 
        opacity: 1;
    }
    100% { 
        transform: translateY(300px) rotate(360deg); 
        opacity: 0;
    }
}

@keyframes pulseButton {
    0% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.1); opacity: 0.3; }
    100% { transform: scale(1); opacity: 0.5; }
}

@keyframes buttonShimmer {
    100% { left: 150%; }
}

/* Responsive Design */
@media (max-width: 768px) {
    .dashboard-stats {
        flex-direction: column;
    }
    
    .submission-list {
        grid-template-columns: 1fr;
    }
    
    .leading-card {
        width: 85%;
        font-size: 12px;
        padding: 12px 12px 60px;
    }
    
    .container {
        width: 92%;
        padding: 15px;
    }
    
    .submission-card {
        width: 95%;
        padding: 12px;
    }
    
    h2 {
        font-size: 18px;
    }
    
    .button-container {
        flex-direction: column;
    }
}

/* Header with Logo Styling */
.header {
    background-color: #006400;
    padding: 18px 0;
    margin-bottom: 18px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden;
    animation: headerSlideDown 0.8s ease-out forwards;
    /* display: flex; */
    flex-direction: row;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 200%;
    height: 5px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
    animation: lightBar 5s infinite linear;
    z-index: 1;
}

.header .logo {
    width: 150px;
    height: 70px;
    /* border-radius: 50%; */
    border: 1px solid rgba(201, 184, 184, 0.7);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease;
    margin-right: 20px;
    object-fit: cover;
    animation: fadeInRight 0.8s ease-out;
    z-index: 2;
    margin: 0 auto;
    border-radius: 5px;
}

.header .logo:hover {
    transform: scale(1.1);
    border-color: rgba(255, 255, 255, 1);
}

.header h1 {
    color: #ffffff;
    font-size: 23px;
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 1px;
    margin: 0;
    animation: titleGlow 3s infinite alternate;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    z-index: 2;
    text-align: center;
    margin: 10px;
}



.header .subheader {
    font-size: 15px;
    color: rgba(255, 255, 255, 0.9);
    margin-top: 4px;
    animation: fadeInUp 0.8s ease 0.3s both;
    width: 100%;
    text-align: center;
    padding-left: 0; /* Removed padding for proper centering */
    z-index: 2;
    display: block; /* Ensures the element is a block for proper centering */
    margin-left: auto;
    margin-right: auto;
}

/* For fallback icon if image fails to load */
#fallbackIcon {
    display: none;
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.2);
    color: white;
    font-size: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 20px;
}

@keyframes fadeInRight {
    from { 
        opacity: 0;
        transform: translateX(-20px);
    }
    to { 
        opacity: 1;
        transform: translateX(0);
    }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .header {
        flex-direction: column;
        padding: 15px 0;
    }
    
    .header .logo {
        margin-right: 0;
        margin-bottom: 10px;
        width: 60px;
        height: 60px;
    }
    
    .header h1 {
        font-size: 22px;
    }
    
    .header .subheader {
        font-size: 13px;
        padding-left: 0;
    }
    
    #fallbackIcon {
        margin-right: 0;
        margin-bottom: 10px;
        width: 60px;
        height: 60px;
        font-size: 22px;
    }
}












/* Responsive CSS for Student Voting Details Page */

/* Container with green border */
.container {
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    width: 90%;
    max-width: 80%;
    margin: 2rem auto;
    border: 2px solid #02590f; /* Green border as requested */
    animation: containerAppear 1s ease 0.8s both;
    transform-origin: center top;
    transition: transform 0.4s ease, box-shadow 0.4s ease;
    position: relative;
    z-index: 2;
}

/* Student Header */
.student-header {
    margin-bottom: 2rem;
    position: relative;
    padding-bottom: 1rem;
    text-align: center;
    animation: slideInFromTop 0.8s ease 1s both;
}

.student-header h2 {
    font-size: 1.8rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #004d00;
}

.student-header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 3px;
    background: #4CAF50;
    border-radius: 3px;
    animation: lineGrow 0.6s ease 1.5s both;
}

/* Back Button */
.navigation {
    margin: 1.5rem 0;
    text-align: center;
    animation: fadeInUp 0.8s ease 2s both;
}

.back-button {
    display: inline-flex;
    align-items: center;
    background: #02590f;
    color: white;
    padding: 0.6rem 1.2rem;
    border: none;
    border-radius: 6px;
    font-family: 'Poppins', sans-serif;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    position: relative;
    overflow: hidden;
}

.back-button i {
    margin-right: 0.5rem;
    transition: transform 0.3s ease;
}

.back-button:hover {
    background: #038c07;
}

.back-button:hover i {
    transform: translateX(-3px);
}

/* Submission Cards */
.submission-card {
    background: #ffffff;
    border-radius: 10px;
    text-align: right;
    margin-bottom: -15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    border-left: 4px solid #4CAF50;
    border: 1px solid #e0e0e0;
    animation: fadeInStagger 0.5s ease-out both;
    animation: fadeInCard 0.7s ease-in-out;
    transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
}


.submission-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.submission-card p {
    margin: 0.6rem 0;
    display: flex;
    align-items: flex-start;
    line-height: 1.4;
    color: #333333;
    transition: transform 0.3s ease;
    font-size: 0.95rem;
}

.submission-card:hover p {
    transform: translateX(3px);
}

.submission-card p strong {
    min-width: 140px;
    font-weight: 500;
    margin-right: 0.5rem;
    color: #004d00;
}

/* No votes message */
.no-votes {
    padding: 3rem 1rem;
    text-align: center;
    animation: pulseAnimation 2s infinite alternate;
}

.no-votes i {
    font-size: 3rem;
    color: #007f00;
    margin-bottom: 1rem;
    opacity: 0.5;
    animation: iconBounce 2s ease infinite;
}

.no-votes p {
    font-size: 1.1rem;
    color: #333333;
    animation: textFadeIn 1s ease 1s both;
}

/* Keyframe animations */
@keyframes containerAppear {
    0% { 
        opacity: 0; 
        transform: scale(0.95);
    }
    100% { 
        opacity: 1; 
        transform: scale(1);
    }
}

@keyframes slideInFromTop {
    0% { 
        opacity: 0;
        transform: translateY(-30px);
    }
    100% { 
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes lineGrow {
    0% { 
        width: 0;
        opacity: 0;
    }
    100% { 
        width: 100px;
        opacity: 1;
    }
}

@keyframes fadeInUp {
    0% { 
        opacity: 0;
        transform: translateY(20px);
    }
    100% { 
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInStagger {
    0% { 
        opacity: 0; 
        transform: translateY(20px);
    }
    100% { 
        opacity: 1; 
        transform: translateY(0);
    }
}

@keyframes pulseAnimation {
    0% { 
        transform: scale(1);
    }
    100% { 
        transform: scale(1.05);
    }
}

@keyframes iconBounce {
    0%, 100% { 
        transform: translateY(0);
    }
    50% { 
        transform: translateY(-10px);
    }
}

@keyframes textFadeIn {
    0% { 
        opacity: 0; 
        transform: translateY(10px);
    }
    100% { 
        opacity: 1; 
        transform: translateY(0);
    }
}

/* Responsive Design */
/* Large Desktop (1200px and above) */
@media screen and (min-width: 1200px) {
    .container {
        width: 70%;
        max-width: 900px;
        padding: 2.5rem;
    }
    
    .student-header h2 {
        font-size: 2rem;
    }
    
    .back-button {
        font-size: 1rem;
        padding: 0.7rem 1.5rem;
    }
    
    .submission-card {
        padding: 1.8rem;
    }
    
    .submission-card p {
        font-size: 1rem;
    }
}

/* Desktop (992px to 1199px) */
@media screen and (min-width: 992px) and (max-width: 1199px) {
    .container {
        width: 75%;
        max-width: 850px;
    }
}

/* Tablet (768px to 991px) */
@media screen and (min-width: 768px) and (max-width: 991px) {
    .container {
        width: 85%;
        padding: 1.8rem;
    }
    
    .student-header h2 {
        font-size: 1.6rem;
    }
    
    .back-button {
        font-size: 0.85rem;
    }
}

/* Small Tablet (576px to 767px) */
@media screen and (min-width: 576px) and (max-width: 767px) {
    .container {
        width: 90%;
        padding: 1.5rem;
        margin: 1.5rem auto;
    }
    
    .student-header h2 {
        font-size: 1.4rem;
    }
    
    .student-header::after {
        width: 80px;
    }
    
    .back-button {
        font-size: 0.8rem;
        padding: 0.5rem 1rem;
    }
    
    .submission-card {
        padding: 1.2rem;
    }
    
    .submission-card p {
        font-size: 0.9rem;
    }
    
    .submission-card p strong {
        min-width: 120px;
    }
}

/* Mobile (375px to 575px) */
@media screen and (min-width: 375px) and (max-width: 575px) {
    .container {
        width: 95%;
        padding: 1.2rem;
        margin: 1rem auto;
        border-width: 1.5px;
    }

    .submission-card {
        margin-top: 0 auto;
    }
    
    
    .student-header {
        margin-bottom: 1.5rem;
    }
    
    .student-header h2 {
        font-size: 1.2rem;
    }
    
    .student-header::after {
        width: 60px;
        height: 2px;
    }
    
    .back-button {
        font-size: 0.75rem;
        padding: 0.4rem 0.9rem;
    }
    
    .submission-card {
        padding: 1rem;
        margin-bottom: 0rem;
    }
    
    .submission-card p {
        font-size: 0.85rem;
        margin: 0.4rem 0;
    }
    
    .submission-card p strong {
        min-width: 100px;
    }
    
    .no-votes i {
        font-size: 2.5rem;
    }
    
    .no-votes p {
        font-size: 1rem;
    }

    .submission-list {
    display: grid;
    align-items: center;
    gap: 90px;
    margin-top: 15px;
    min-height: 10px;
    width: 100%;
}

.submission-card p {
    display: grid;
    grid-template-columns: auto 1fr; /* Labels take minimal space, inputs expand */
    gap: 1px;
    align-items: center;
}

.submission-card label {
    font-weight: bold;
    white-space: nowrap; /* Prevents labels from breaking */
}

.submission-card input {
    flex: 1;
    min-width: 100px;
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 3px;
    background-color: #f9f9f9;
    font-size: 14px;
    text-align: start; 
}

/* Button Styling */
button {
    margin-top: 10px;
    padding: 8px 12px;
    background-color: #038c07;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #026b05;
}



.leading-card {
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    text-align: left; /* Align the text inside the card to the left */
    max-width: 100%;
    margin: auto;
    max-height: 1800px;
    overflow: hidden;
    margin-top: 10px;
    margin-bottom: -100px;
}



.card-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
    color: #038c07;
}

.details p {
    display: flex;
    justify-content: space-between;
    margin: 5px 0;
    font-size: 14px;
}

.details span {
    font-weight: lighter;
    color: #333;
    text-align: left; 
    display: inline-block; 
    width: 50%;
    padding: 10px;
}

.button-wrapper {
    margin-top: 105px;
}

button {
    padding: 8px 12px;
    background-color: #038c07;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #026b05;
}

/* Input fields inside the leading card */
.leading-card input {
    text-align: left;  /* Align text to the left inside inputs */
    padding: 6px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: #f9f9f9;
    width: 100%;
    font-size: 14px;
}

.submission-card p strong::after,
.leading-card p strong::after {
    content: '';
    position: absolute;
    right: 6px;
    color: #038c07 !important;
    font-weight: 700;
    text-shadow: 0 0 1px rgba(0, 0, 0, 0.2);
    transform: translateY(-1px);
}

.submission-card p:hover strong::after,
.leading-card p:hover strong::after {
    color: #04c70b !important;
}
}

/* Small Mobile (Up to 374px) */
@media screen and (max-width: 374px) {
    
    .container {
        width: 95%;
        padding: 1rem;
        margin: 0.8rem auto;
        border-width: 1px;
    }
    
    .student-header h2 {
        font-size: 1.1rem;
    }
    
    .student-header::after {
        width: 50px;
        height: 2px;
    }
    
    .back-button {
        font-size: 0.7rem;
        padding: 0.4rem 0.8rem;
    }
    
    .back-button i {
        margin-right: 0.3rem;
    }
    
    .submission-card {
        padding: 0.8rem;
        margin-bottom: 0.8rem;
    }
    
    .submission-card p {
        font-size: 0.8rem;
        display: block; /* Stack on very small screens */
    }
    
    .submission-card p strong {
        min-width: auto;
        display: block;
        margin-bottom: 0.2rem;
    }
    
    .no-votes {
        padding: 2rem 0.8rem;
    }
    
    .no-votes i {
        font-size: 2rem;
    }
    
    .no-votes p {
        font-size: 0.9rem;
    }
}

/* Small Height (Up to 574px height) */
@media screen and (max-height: 574px) {
    .container {
        margin: 1rem auto;
        padding: 1rem;
        max-height: 75vh;
        overflow-y: auto;
    }
    
    .student-header {
        margin-bottom: 1rem;
    }
    
    .student-header h2 {
        font-size: 1.2rem;
    }
    
    .student-header::after {
        bottom: -5px;
    }
    
    .navigation {
        margin: 1rem 0;
    }
    
    .submission-card {
        padding: 0.8rem;
        margin-bottom: 0.8rem;
    }
}

/* Landscape orientation adjustments */
@media screen and (max-height: 500px) and (orientation: landscape) {
    .container {
        width: 85%;
        max-width: 600px;
        margin: 0.8rem auto;
        padding: 0.8rem;
        max-height: 70vh;
        overflow-y: auto;
    }
    
    .student-header h2 {
        font-size: 1.1rem;
    }
    
    .back-button {
        font-size: 0.75rem;
        padding: 0.4rem 0.8rem;
    }
    
    .submission-card {
        margin-bottom: 0.6rem;
    }
    
}

@media (max-width: 552px) {


    .header .logo {
    width: 100px;
    height: 60px;
}

.header h1 {
    font-size: 15px
}

.subheader1 {
    font-size: 15px
}

.stat-card {
    background-color: #006407;
    border-radius: 8px;
    padding: 1px;
    flex: 1;
    display: flex;
    width: 100%;
    margin: 0 auto;
}

.stat-content h3 {
    font-size: 14px;
    font-weight: 600;
    color: white;
}

.stat-content p {
    margin: 0;
    font-size: 14px;
}

.container h2{
    font-size: 14px;
}

.leading-card h3 {
    color: #ffffff;
    font-size: 12px !important;
    letter-spacing: 2px;
    width: 150px;
}

}




::-webkit-scrollbar {
    display: none
}










@media (max-width: 360px) {



.submission-list {
    display: grid;
    align-items: center;
    gap: 102px;
    margin-top: 15px;
    min-height: 10px;
    width: 90%;
}

.submission-card p {
    display: grid;
    grid-template-columns: auto 1fr; /* Labels take minimal space, inputs expand */
    gap: 10px;
    align-items: center;
}

.submission-card label {
    font-weight: bold;
    white-space: nowrap; /* Prevents labels from breaking */
}

.submission-card input {
    flex: 1;
    min-width: 100px;
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 3px;
    background-color: #f9f9f9;
    font-size: 14px;
    text-align: start; 
}

/* Button Styling */
button {
    margin-top: 10px;
    padding: 8px 12px;
    background-color: #038c07;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #026b05;
}



.leading-card {
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    text-align: left; /* Align the text inside the card to the left */
    max-width: 100%;
    margin: auto;
    height: 900px;
}



.card-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
    color: #038c07;
}

.details p {
    display: flex;
    justify-content: space-between;
    margin: 5px 0;
    font-size: 14px;
}

.details span {
    font-weight: lighter;
    color: #333;
    text-align: left; 
    display: inline-block; 
    width: 50%;
    padding: 10px;
}




.button-wrapper {
    margin-top: 105px;
}

button {
    padding: 8px 12px;
    background-color: #038c07;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #026b05;
}

/* Input fields inside the leading card */
.leading-card input {
    text-align: left;  /* Align text to the left inside inputs */
    padding: 6px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: #f9f9f9;
    width: 70%;
    font-size: 14px;
}



.submission-card p strong::after,
.leading-card p strong::after {
    content: '';
    position: absolute;
    right: 6px;
    color: #038c07 !important;
    font-weight: 700;
    text-shadow: 0 0 1px rgba(0, 0, 0, 0.2);
    transform: translateY(-1px);
}

.submission-card p:hover strong::after,
.leading-card p:hover strong::after {
    color: #04c70b !important;
}




/* Define slideLabel animation if not already defined elsewhere */
@keyframes slideLabel {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Responsive Styles */

/* Tablet (768px to 992px) */
@media screen and (max-width: 992px) {
    .footer {
        padding: 12px 0;
    }
    
    .footer p {
        font-size: 13px;
    }
    
    .social-icons a {
        font-size: 22px;
        margin: 0 8px;
    }
    
    .social-icons a:hover {
        font-size: 24px;
        margin: 0 10px;
    }
}

/* Mobile (576px to 768px) */
@media screen and (max-width: 768px) {
    .footer {
        padding: 10px 0;
    }
    
    .footer p {
        font-size: 12px;
        margin: 4px 0;
        padding: 0 15px; /* Add padding for better text wrapping */
    }
    
    .social-icons {
        padding: 3px 0;
    }
    
    .social-icons a {
        font-size: 20px;
        margin: 0 7px;
    }
    
    .social-icons a:hover {
        font-size: 22px;
        margin: 0 8px;
    }

    .container {
        margin-top: 40px;
    }
}

/* Small Mobile (up to 576px) */
@media screen and (max-width: 576px) {
    .footer {
        padding: 8px 0;
    }
    
    .footer p {
        font-size: 11px;
        line-height: 1.4;
        margin: 3px 0;
    }
    
    .social-icons {
        flex-wrap: wrap; /* Allow icons to wrap if needed */
        padding: 2px 0;
    }
    
    .social-icons a {
        font-size: 18px;
        margin: 0 6px;
    }
    
    .social-icons a:hover {
        font-size: 20px;
        margin: 0 7px;
    }
}

/* Very Small Screens (up to 320px) */
@media screen and (max-width: 320px) {
    .footer {
        padding: 6px 0;
    }
    
    .footer p {
        font-size: 10px;
        margin: 2px 0;
    }
    
    .social-icons a {
        font-size: 16px;
        margin: 0 5px;
    }
    
    .social-icons a:hover {
        font-size: 18px;
        margin: 0 6px;
    }
}

/* Fix for devices with notches */
@supports (padding: max(0px)) {
    .footer {
        padding-bottom: max(15px, env(safe-area-inset-bottom));
    }
}

/* Fix for landscape mode on mobile */
@media screen and (max-height: 450px) and (orientation: landscape) {
    .footer {
        position: relative; /* Change from fixed to relative in landscape */
    }
}

/* Adjustments for iOS Safari */
@supports (-webkit-touch-callout: none) {
    .footer {
        /* Fix for iOS Safari viewport issues */
        bottom: env(safe-area-inset-bottom, 0);
    }
}

}









    </style>
</head>
<body>
    <div class="header">
        <img src="Tiss-logo.jpeg" alt="School Logo" class="logo" onerror="this.style.display='none'; document.getElementById('fallbackIcon').style.display='block'">

        <h1>Digital Student Recognition Platform</h1>
        <div class="subheader1">System Administrator's Dashboard</div>
        <div class="subheader">Monitor and manage student nominations for the Student of the Week program</div>
    </div>

    <div class="dashboard-stats">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-content">
                <h3 id="totalStudents">0</h3>
                <p>Total Nominations</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-award"></i>
            </div>
            <div class="stat-content">
                <h3 id="leadingVotes">0</h3>
                <p>Leading STUDENT Votes</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-school"></i>
            </div>
            <div class="stat-content">
                <h3 id="uniqueClasses">0</h3>
                <p>Departments Represented</p>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>Student of the Week Nominations</h2>
        <div id="submissionsContainer" class="submission-list">
            <!-- Display form submissions here -->
        </div>
        
        <div class="button-container">
            <button class="download-button" onclick="downloadRecords()">
                <i class="fas fa-download"></i> Download Records
            </button>
            
            <button class="clear-button" onclick="clearRecords()">
                <i class="fas fa-trash"></i> Clear Records
            </button>
        </div>
    </div>

                <!-- FontAwesome for Icons -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

                <style>
                    /* Google Fonts */
                    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');
            
            
                    .footer p {
                        font-size: 14px;
                        margin-top: 5px;
                    } 
            
             
                /* Footer Styling */
                .footer {
                    z-index: 999;
                  background-color: #004d00;
                  text-align: center;
                  color: rgb(232, 227, 203);
                  text-align: center;
                  margin-top: 20px;
                  bottom: 0;
                  width: 100%;
                  margin: 0 auto;
                  padding: 15px 0;
                }
            
                .social-icons a {
                  margin: 0 10px;
                  color: rgb(232, 227, 203);
                  font-size: 24px;
                  margin-bottom: 30px;
                  text-decoration: none;
                }
            
                .social-icons a {
              transition: transform 0.3s ease, margin 0.3s ease, color 0.3s ease, font-size 0.3s ease;
            }
            
            .social-icons a:hover {
              margin: 0 12px; /* Increased margin to emphasize the zoom */
              color: rgb(255, 255, 255);
              font-size: 26px; /* Slightly increase font size for effect */
              transform: scale(1.1); /* Zoom effect */
              text-decoration: none; /* Remove underline on hover */
            }
                </style>

    <!-- Footer Section -->
        <footer class="footer">
            <div class="social-icons">
                <a href="https://www.facebook.com/TaibahInternationalSchool" target="_blank" title="Facebook"><i class="fa-brands fa-facebook"></i></a>
                <a href="https://x.com/TaibahIntSchool" target="_blank" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
                <a href="http://www.instagram.com/taibahintschool/" target="_blank" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
                <a href="https://linkedin.com" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin"></i></a>
            </div>
            <p>&copy; <span id="year"></span> Taibah International School. All Rights Reserved.</p>
        </footer>

    <script>
        // Load form submissions from localStorage
        let formSubmissions = JSON.parse(localStorage.getItem("formSubmissions")) || [];
        
        // Update dashboard statistics
        function updateDashboardStats() {
            const totalNominations = formSubmissions.length;
            document.getElementById('totalStudents').textContent = totalNominations;
            
            const frequencies = getVoteFrequencies();
            const maxVotes = Object.values(frequencies).length > 0 ? Math.max(...Object.values(frequencies)) : 0;
            document.getElementById('leadingVotes').textContent = maxVotes;
            
            const uniqueClasses = new Set(formSubmissions.map(sub => sub.classAndStream)).size;
            document.getElementById('uniqueClasses').textContent = uniqueClasses;
        }
        
        // Count frequency of votes for each student
        function getVoteFrequencies() {
            let frequencies = {};
            formSubmissions.forEach(submission => {
                let studentName = submission.name;
                frequencies[studentName] = (frequencies[studentName] || 0) + 1;
            });
            return frequencies;
        }
        
        // Sort submissions by vote frequency (and most recent date first)
        function getSortedSubmissionsByVotes() {
            let frequencies = getVoteFrequencies();
            let sortedNames = Object.keys(frequencies).sort((a, b) => {
                let submissionA = formSubmissions.find(sub => sub.name === a);
                let submissionB = formSubmissions.find(sub => sub.name === b);
                // Sort by frequency, then by date (most recent)
                return frequencies[b] - frequencies[a] || new Date(submissionB.date) - new Date(submissionA.date);
            });
            
            let sortedSubmissions = [];
            sortedNames.forEach(name => {
                let submission = formSubmissions.find(sub => sub.name === name);
                sortedSubmissions.push({
                    ...submission,
                    votes: frequencies[name]
                });
            });
            
            return sortedSubmissions;
        }
        
        // Render sorted submissions
        function displaySubmissions() {
            let submissionsContainer = document.getElementById("submissionsContainer");
            submissionsContainer.innerHTML = ""; // Clear any previous content
            
            updateDashboardStats(); // Update the dashboard stats
            
            if (formSubmissions.length === 0) {
                submissionsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <p>No nominations have been submitted yet. Nominations will appear here once teachers start submitting them.</p>
                    </div>`;
                return;
            }
            
            let sortedSubmissions = getSortedSubmissionsByVotes();
            let leadingStudent = sortedSubmissions.shift(); // Get the leading student
            
            // Display leading student card at the top
            let leadingCard = document.createElement("div");
            
            leadingCard.innerHTML = `
            <h3 class="card-title">Leading Student</h3>
            <div class="details">
                <p><strong>Voted Student:</strong> <span>${leadingStudent.name}</span></p>
                <p><strong>Department:</strong> <span>${leadingStudent.classAndStream}</span></p>
                <p><strong>Reason:</strong> <span>${leadingStudent.reason}</span></p>
                <p><strong>Voting Teacher:</strong> <span>${leadingStudent.teachersName}</span></p>
                <p><strong>Total Votes:</strong> <span>${leadingStudent.votes}</span></p>
                <p><strong>Date:</strong> <span>${leadingStudent.date}</span></p>
                </div>
                <div class="button-wrapper">
                    <button onclick="viewAllVotes('${leadingStudent.name}')">View All</button>
                    </div>
                    `;
                    
                    submissionsContainer.appendChild(leadingCard);
                    leadingCard.classList.add("submission-card", "leading-card");

            
            // Create a container for other submissions
            let otherSubmissions = document.createElement("div");
            otherSubmissions.style.display = "grid";
            otherSubmissions.style.gridTemplateColumns = "repeat(1, 1fr)";
            otherSubmissions.style.gap = "20px";
            otherSubmissions.style.width = "100%";
            otherSubmissions.style.marginTop = "20px";
            submissionsContainer.appendChild(otherSubmissions);
            
            // Display remaining submissions in two columns
            sortedSubmissions.forEach(submission => {
    let submissionCard = document.createElement("div");
    submissionCard.classList.add("submission-card");
    submissionCard.innerHTML = `
        <p>
            <label>Voted Student:</label> <input type="text" value="${submission.name}" readonly>
            <label>Total Votes:</label> <input type="number" value="${submission.votes}" readonly>
            <label>Date:</label> <input type="text" value="${submission.date}" readonly>
        </p>
        <button onclick="viewAllVotes('${submission.name}')">View All</button>
    `;
    otherSubmissions.appendChild(submissionCard);
});


            
            // Add winning effects to leading card
            addWinningEffectsToLeadingCard();
            
            // Initialize the ranking indicators
            initializeRankingOnHover();
            
            // Add staggered animation for cards
            applyStaggeredAnimations();
        }
        
        // View all submissions for a specific student
        function viewAllVotes(studentName) {
            localStorage.setItem("selectedStudent", studentName);
            window.location.href = "student-voting-details.html";
        }
        
        // Download all records as an Excel file with names sorted by most votes
        function downloadRecords() {
            const XLSX = window.XLSX;  // Use the xlsx.js library for this
            
            if (formSubmissions.length === 0) {
                alert("No records to download");
                return;
            }
            
            // Count the frequency of votes for each student
            let frequencies = getVoteFrequencies();
            
            // Sort formSubmissions based on vote frequency (in descending order)
            formSubmissions.sort((a, b) => {
                let votesA = frequencies[a.name] || 0;
                let votesB = frequencies[b.name] || 0;
                return votesB - votesA;  // Sort by votes in descending order
            });
            
            // Add the total votes row at the end of each student record
            formSubmissions.forEach(submission => {
                // submission.totalVotes = frequencies[submission.name] || 0;
            });
            
            // Create Excel sheet
            const ws = XLSX.utils.json_to_sheet(formSubmissions, {
                header: ["name", "classAndStream", "reason",  "date"]
            });
            
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Voting Records");
            
            // Generate and download the Excel file
            XLSX.writeFile(wb, "Voting_Records.xlsx");
        }
        
        // Function to clear records with confirmation
        function clearRecords() {
            // Ask the user for confirmation before clearing the records
            const userConfirmed = window.confirm("Are you sure you want to clear all records? This action cannot be undone.");
            
            if (userConfirmed) {
                // Clear the data
                localStorage.removeItem("formSubmissions");
                
                console.log("Records have been cleared.");
                formSubmissions = [];
                displaySubmissions();
            } else {
                console.log("Records were not cleared.");
            }
        }
        
        // Add winning effects to the leading student card
        function addWinningEffectsToLeadingCard() {
            const leadingCard = document.querySelector('.leading-card');
            
            if (leadingCard && !leadingCard.querySelector('.trophy-container')) {
                // Add trophy icon
                const trophyContainer = document.createElement('div');
                trophyContainer.className = 'trophy-container';
                trophyContainer.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="100%" height="100%" fill="#FFD700" stroke="#b38b00" stroke-width="0.5">
                        <path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM7 10.82C5.84 10.4 5 9.3 5 8V7h2v3.82zM19 8c0 1.3-.84 2.4-2 2.82V7h2v1z"/>
                    </svg>
                `;
                leadingCard.appendChild(trophyContainer);
                
                // Add confetti container
                const confettiContainer = document.createElement('div');
                confettiContainer.className = 'confetti-container';
                
                // Create confetti pieces
                for (let i = 0; i < 20; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    // Randomize position
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.animationDelay = `${Math.random() * 5}s`;
                    
                    // Randomize rotation
                    const rotation = Math.floor(Math.random() * 360);
                    confetti.style.transform = `rotate(${rotation}deg)`;
                    
                    confettiContainer.appendChild(confetti);
                }
                
                leadingCard.appendChild(confettiContainer);
            }
        }
        
        // Function to calculate and show position on hover
        function initializeRankingOnHover() {
            // Get all student cards (excluding the leading card)
            const studentCards = document.querySelectorAll('.submission-card:not(.leading-card)');
            
            // First, collect data about all students and their votes
            const studentsData = [];
            
            // Get data from the leading card first
            const leadingCard = document.querySelector('.leading-card');
            if (leadingCard) {
                const votesElement = leadingCard.querySelector('p:nth-child(6)');
                if (votesElement) {
                    const votesText = votesElement.textContent;
                    const votes = parseInt(votesText.match(/\d+/)[0]); // Extract the number
                    const nameElement = leadingCard.querySelector('p:nth-child(1)');
                    const name = nameElement ? nameElement.textContent.replace('Name:', '').trim() : 'Unknown';
                    
                    studentsData.push({
                        name: name,
                        votes: votes,
                        element: leadingCard
                    });
                }
            }
            
            // Get data from all other student cards
            studentCards.forEach(card => {
                const votesElement = card.querySelector('p:nth-child(6)');
                if (votesElement) {
                    const votesText = votesElement.textContent;
                    const votes = parseInt(votesText.match(/\d+/)[0]); // Extract the number
                    const nameElement = card.querySelector('p:nth-child(1)');
                    const name = nameElement ? nameElement.textContent.replace('Name:', '').trim() : 'Unknown';
                    
                    studentsData.push({
                        name: name,
                        votes: votes,
                        element: card
                    });
                }
            });
            
            // Sort by votes in descending order
            studentsData.sort((a, b) => b.votes - a.votes);
            
            // Add position rank based on the sort
            studentsData.forEach((student, index) => {
                student.position = index + 1;
            });
            
            // Now add mouseover and mouseout event listeners to all cards
            [...studentCards, leadingCard].forEach(card => {
                if (!card) return; // Skip if card is undefined
                
                // Remove existing position indicators
                const existingIndicator = card.querySelector('.position-indicator');
                if (existingIndicator) {
                    existingIndicator.remove();
                }
                
                // Get student name to identify which position to show
                const nameElement = card.querySelector('p:nth-child(1)');
                if (!nameElement) return;
                
                const studentName = nameElement.textContent.replace('Name:', '').trim();
                const studentData = studentsData.find(s => s.name === studentName);
                if (!studentData) return;
                
                // Create position indicator element
                const positionIndicator = document.createElement('div');
                positionIndicator.className = 'position-indicator';
                positionIndicator.textContent = `#${studentData.position}`;
                
                // Set color based on position
                let bgColor = '#038c07'; // Default green
                if (studentData.position === 1) bgColor = '#FFD700'; // Gold
                else if (studentData.position === 2) bgColor = '#C0C0C0'; // Silver
                else if (studentData.position === 3) bgColor = '#CD7F32'; // Bronze
                
                positionIndicator.style.backgroundColor = bgColor;
                
                card.style.position = 'relative';
                card.appendChild(positionIndicator);
                
                // Show on hover
                card.addEventListener('mouseenter', () => {
                    positionIndicator.style.opacity = '1';
                    positionIndicator.style.transform = 'scale(1)';
                });
                
                // Hide when not hovering
                card.addEventListener('mouseleave', () => {
                    positionIndicator.style.opacity = '0';
                    positionIndicator.style.transform = 'scale(0.8)';
                });
            });
        }
        
        // Apply staggered animations to cards
        function applyStaggeredAnimations() {
            setTimeout(() => {
                const cards = document.querySelectorAll('.submission-card');
                cards.forEach((card, index) => {
                    card.style.animationDelay = `${0.1 * index}s`;
                });
            }, 500);
        }
        
        // Function to automatically send Excel file via email at scheduled time
        function setupAutomaticEmailSchedule() {
            // Only proceed if the EmailJS library is already loaded or can be loaded
            if (typeof emailjs !== 'undefined' || document.querySelector('script[src*="emailjs"]')) {
                console.log("EmailJS already loaded");
                initEmailService();
            } else {
                // Try to load EmailJS library
                try {
                    const emailjsScript = document.createElement('script');
                    emailjsScript.src = 'https://cdn.emailjs.com/dist/email.min.js';
                    emailjsScript.onload = function() {
                        console.log("EmailJS loaded successfully");
                        initEmailService();
                    };
                    emailjsScript.onerror = function() {
                        console.error("Failed to load EmailJS library");
                    };
                    document.head.appendChild(emailjsScript);
                } catch (e) {
                    console.error("Error setting up email service:", e);
                }
            }
    
            function initEmailService() {
                try {
                    if (typeof emailjs !== 'undefined') {
                        emailjs.init("1ytedkFbthZIF21AwiKeY"); // Your EmailJS user ID
                        console.log("Email service initialized");
                    } else {
                        console.error("EmailJS not available after loading");
                    }
                } catch (e) {
                    console.error("Error initializing EmailJS:", e);
                }
            }
    
            // Function to check if it's time to send the weekly email
            function checkScheduleAndSendEmail() {
                try {
                    const now = new Date();
                    const day = now.getDay(); // 0 = Sunday
                    const hours = now.getHours();
                    const minutes = now.getMinutes();
                    
                    // Check if it's Sunday at 3:10 AM (between 3:10 and 3:15)
                    if (day === 0 && hours === 3 && minutes >= 10 && minutes < 15) {
                        // Check if we haven't sent the email today already
                        const lastSentDate = localStorage.getItem('lastEmailSent');
                        const today = new Date().toDateString();
                        
                        if (lastSentDate !== today) {
                            console.log("Scheduled time reached. Preparing to send email.");
                            sendWeeklyEmailReport();
                            // Mark as sent today
                            localStorage.setItem('lastEmailSent', today);
                        }
                    }
                } catch (e) {
                    console.error("Error checking schedule:", e);
                }
            }
            
            // Function to send the weekly email with Excel attachment
            function sendWeeklyEmailReport() {
                try {
                    if (typeof emailjs === 'undefined') {
                        console.error("EmailJS not available");
                        return;
                    }
                    
                    if (!formSubmissions || formSubmissions.length === 0) {
                        console.log("No records to send");
                        return;
                    }
                    
                    if (typeof XLSX === 'undefined') {
                        console.error("XLSX library not available");
                        return;
                    }
                    
                    // Prepare the Excel file
                    const frequencies = getVoteFrequencies();
                    
                    // Create a copy of formSubmissions to avoid modifying the original
                    const submissionsCopy = JSON.parse(JSON.stringify(formSubmissions));
                    
                    submissionsCopy.sort((a, b) => {
                        let votesA = frequencies[a.name] || 0;
                        let votesB = frequencies[b.name] || 0;
                        return votesB - votesA;
                    });
                    
                    submissionsCopy.forEach(submission => {
                        submission.totalVotes = frequencies[submission.name] || 0;
                    });
                    
                    const ws = XLSX.utils.json_to_sheet(submissionsCopy, {
                        header: ["name", "classAndStream", "reason", "date", "totalVotes"]
                    });
                    
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, "Voting Records");
                    
                    // Convert to binary string
                    const excelBinary = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
                    
                    // Convert binary to base64 for email attachment
                    const base64Excel = arrayBufferToBase64(s2ab(excelBinary));
                    
                    // Format date for email subject
                    const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
                    const formattedDate = new Date().toLocaleDateString('en-US', dateOptions);
                    
                    // Prepare email parameters
                    const emailParams = {
                        to_email: "",
                        from_name: "Student Vote Admin Dashboard",
                        subject: `Weekly Student Voting Report - ${formattedDate}`,
                        message: `Please find attached the weekly student voting records as of ${formattedDate}. This is an automated report.`,
                        attachment: base64Excel,
                        filename: `Voting_Records_${new Date().toISOString().split('T')[0]}.xlsx`
                    };
                    
                    // Send the email with your specific credentials
                    emailjs.send("", "", emailParams)
                        .then(function(response) {
                            console.log("SUCCESS: Email sent!", response.status);
                        })
                        .catch(function(error) {
                            console.error("FAILED: Email not sent!", error);
                        });
                        
                } catch (e) {
                    console.error("Error sending email report:", e);
                }
            }
            
            // Helper function to convert string to ArrayBuffer
            function s2ab(s) {
                try {
                    const buf = new ArrayBuffer(s.length);
                    const view = new Uint8Array(buf);
                    for (let i = 0; i < s.length; i++) {
                        view[i] = s.charCodeAt(i) & 0xFF;
                    }
                    return buf;
                } catch (e) {
                    console.error("Error converting string to ArrayBuffer:", e);
                    return new ArrayBuffer(0);
                }
            }
            
            // Helper function to convert ArrayBuffer to base64
            function arrayBufferToBase64(buffer) {
                try {
                    let binary = '';
                    const bytes = new Uint8Array(buffer);
                    for (let i = 0; i < bytes.byteLength; i++) {
                        binary += String.fromCharCode(bytes[i]);
                    }
                    return window.btoa(binary);
                } catch (e) {
                    console.error("Error converting ArrayBuffer to base64:", e);
                    return '';
                }
            }
    
            // Check schedule every minute, with error handling
            try {
                setInterval(function() {
                    try {
                        checkScheduleAndSendEmail();
                    } catch (e) {
                        console.error("Error in schedule check:", e);
                    }
                }, 60000);
                
                // Also check immediately on setup
                checkScheduleAndSendEmail();
            } catch (e) {
                console.error("Error setting up schedule interval:", e);
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            displaySubmissions();
            
            // Update rankings if data changes
            document.addEventListener('studentsDataUpdated', function() {
                // Remove existing position indicators
                document.querySelectorAll('.position-indicator').forEach(el => el.remove());
                // Reinitialize
                setTimeout(initializeRankingOnHover, 100);
            });
            
            // Set current year in footer
            document.getElementById('year').textContent = new Date().getFullYear();
            
            // Initialize the automatic email scheduling with a slight delay
            setTimeout(function() {
                try {
                    setupAutomaticEmailSchedule();
                } catch (e) {
                    console.error("Failed to set up email scheduling:", e);
                }
            }, 1000);
        });
    </script>
</body>
</html>